digraph D {

    // Raw inputs
    consensus [shape=box, style=filled, color=grey]
    reference [shape=box, style=filled, color=grey]

    // Rules
    cat_ref [shape=box]
    makeblastdb [shape=box]
    gather_cons [shape=box]
    blastn [shape=box]
    parse_blast [shape=box]
    blast_all [shape=box]
    aln_ref [shape=box, style=dashed]
    trim_ref [shape=box, style=dashed]
    aln_to_ref [shape=box, style=dashed]
    guide_tree [shape=box, style=dashed]
    move_guide_tree [shape=box, style=dashed]
    iqtree [shape=box, style=dashed]
    move_iqtree [shape=box, style=dashed]
    plot_tree [shape=box, style=dashed]
    all [shape=box]

    // Edges before checkpoint
    consensus -> gather_cons
    reference -> {cat_ref, aln_ref}
    cat_ref -> makeblastdb
    makeblastdb -> blastn
    gather_cons -> blastn
    blastn -> parse_blast
    parse_blast -> blast_all [label=expand]
    parse_blast -> aln_to_ref
    blast_all -> all

    // Edges after checkpoint
    aln_ref -> trim_ref
    trim_ref -> {aln_to_ref, guide_tree}
    aln_to_ref -> iqtree
    guide_tree -> move_guide_tree
    move_guide_tree -> iqtree
    iqtree -> move_iqtree
    move_iqtree -> plot_tree
    plot_tree -> all [style=dashed, label="expand"]
}
